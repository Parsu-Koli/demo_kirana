@model KiranaStoreUI.Models.User

@{
    ViewData["Title"] = "Register";
}

<h2 class="mb-4 text-success fw-bold">
    <i class="bi bi-person-plus-fill"></i> Register
</h2>

<div class="card shadow-lg border-0 rounded-4 p-4 mx-auto" style="max-width: 500px;">
    <form asp-action="Register" method="post">

        <div class="mb-3">
            <label class="form-label fw-semibold">Full Name</label>
            <input asp-for="FullName" class="form-control form-control-lg rounded-3" placeholder="Enter full name" />
            <span asp-validation-for="FullName" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Username</label>
            <input asp-for="Username" id="username" class="form-control form-control-lg rounded-3" placeholder="Enter username" />
            <span asp-validation-for="Username" class="text-danger"></span>
            <span id="username-msg" class="text-danger fw-semibold"></span>
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Password</label>
            <input asp-for="Password" type="password" class="form-control form-control-lg rounded-3" placeholder="Enter password" />
            <span asp-validation-for="Password" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Phone</label>
            <input asp-for="Phone" class="form-control form-control-lg rounded-3" placeholder="Enter phone number" />
            <span asp-validation-for="Phone" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label class="form-label fw-semibold">Role</label>
            <select asp-for="Role" class="form-select form-select-lg rounded-3">
                <option value="">-- Select Role --</option>
                <option>Admin</option>
                <option>Employee</option>
                <option>Cashier</option>
            </select>
            <span asp-validation-for="Role" class="text-danger"></span>
        </div>

        <button type="submit" class="btn btn-success btn-lg w-100 shadow">
            <i class="bi bi-person-plus-fill"></i> Register
        </button>

        <div class="mt-3 text-center">
            <a asp-action="Login" class="text-decoration-none">Already have an account? Login</a>
        </div>

    </form>
</div>

@section Scripts {
    <script>
        document.getElementById("username").addEventListener("blur", async function () {
            let username = this.value;
            if (!username) return;

            let response = await fetch(`/User/IsUsernameExists?username=${username}`);
            let exists = await response.json();
            document.getElementById("username-msg").innerText = exists ? "Username already taken!" : "";
        });
    </script>
}
